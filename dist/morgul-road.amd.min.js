define(function(){"use strict";function e(e){return"[object Object]"===c.call(e)}function n(e){return"[object String]"===c.call(e)}function t(){}function r(e,n){for(var t=0;t<e.length&&!n(e[t],t++););}function o(e,n){return/รถ/.test(s[n])?encodeURI(e[n]):e[n]}function a(e,n){var t=o(e,n).slice(f[n].length);return"pathname"!==n||/^\//.test(t)||(t="/"+t),t}function i(i){function c(e,t,r,u){if(0===arguments.length)return w;if(3===arguments.length&&n(t)){g=function(n){if(w=n,!s(e,r,n)){if(R)throw new Error("Ensure the default route matches one of the routes defined in route");R=!0,c(t,!0),R=!1}};var v="hash"===c.mode?"onhashchange":"onpopstate";return window[v]=function(){var e=a(location,c.mode);"pathname"===c.mode&&(e+=o(location,"search")),w!==e&&g(e)},i.preRedraw=h,void window[v]()}if(e.addEventListener||e.attachEvent){var E="pathname"!==c.mode?a(location,"pathname"):"";return e.href=E+f[c.mode]+u.attrs.href,void(e.addEventListener?(e.removeEventListener("click",m),e.addEventListener("click",m)):(e.detachEvent("onclick",m),e.attachEvent("onclick",m)))}if(n(e)){var y=w;w=encodeURI(e);var I,U=t||{},b=w.indexOf("?");I=b>-1?p(w.slice(b+1)):{};for(var C in U)l.call(U,C)&&(I[C]=U[C]);var j,O=d(I);j=b>-1?w.slice(0,b):w,O&&(w=j+(-1===j.indexOf("?")?"?":"&")+O);var S=(3===arguments.length?r:t)===!0||y===w;if(window.history.pushState){var k=S?"replaceState":"pushState";i.preRedraw=h,i.postRedraw=function(){window.history[k](null,document.title,f[c.mode]+w)},g(w)}else location[c.mode]=w,g(w)}}function s(e,n,t){v={};var o=t.indexOf("?"),a=0;-1!==o&&(v=p(t.substr(o+1,t.length)),t=t.substr(0,o));var c=Object.keys(n).map(encodeURI),u=c.indexOf(t);if(-1!==u)return i(e,n[c[u]]),!0;for(var f in n)if(l.call(n,f)){if(f=c[a++],f===t)return i(e,n[f]),!0;var s=new RegExp("^"+f.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(s.test(t))return t.replace(s,function(){var t=f.match(/:[^\/]+/g)||[],o=[].slice.call(arguments,1,-2);r(t,function(e,n){v[e.replace(/:|\./g,"")]=decodeURIComponent(o[n])}),i(e,n[f])}),!0}}function h(){"hash"!==c.mode&&location.hash?location.hash=location.hash:window.scrollTo(0,0)}function d(n,t){var o={},a=[];for(var i in n)if(l.call(n,i)){var c=t?t+"["+i+"]":i,f=n[i];if(null===f)a.push(encodeURIComponent(c));else if(e(f))a.push(d(f,c));else if(u(f)){var s=[];o[c]=o[c]||{},r(f,function(e){o[c][e]||(o[c][e]=!0,s.push(encodeURIComponent(c)+"="+encodeURIComponent(e)))}),a.push(s.join("&"))}else void 0!==f&&a.push(encodeURIComponent(c)+"="+encodeURIComponent(f))}return a.join("&")}function p(e){if(""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));var n=e.split("&"),t={};return r(n,function(e){var n=e.split("="),r=decodeURIComponent(n[0]),o=2===n.length?decodeURIComponent(n[1]):null;null!=t[r]?(u(t[r])||(t[r]=[t[r]]),t[r].push(o)):t[r]=o}),t}function m(e){if(e=e||event,!(e.ctrlKey||e.metaKey||e.shiftKey||2===e.which)){e.preventDefault?e.preventDefault():e.returnValue=!1;var n,t=e.currentTarget||e.srcElement;for(n="pathname"===c.mode&&t.search?p(o(t,"search")):{};t&&!/a/i.test(t.nodeName);)t=t.parentNode;c(a(t,c.mode),n)}}var v,w,g=t,R=!1;return c.param=function(e){if(!v)throw new Error("You must call route(element, defaultRoute, routes) before calling route.param()");return e?v[e]:v},c.mode="search",c.buildQueryString=d,c.parseQueryString=p,c}var c={}.toString,u=Array.isArray||function(e){return"[object Array]"===c.call(e)},l={}.hasOwnProperty,f={pathname:"",hash:"#",search:"?"},s=document.createElement("a");return s.href="/รถ?รถ#รถ",i});